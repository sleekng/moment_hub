<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Wishlist - Moment Hub</title>
    
    <!-- This page will be used by social media crawlers -->
    <!-- The actual meta tags will be injected by JavaScript based on URL parameters -->
    
    <!-- Default meta tags -->
    <meta property="og:title" content="Wishlist - Moment Hub">
    <meta property="og:description" content="Check out this amazing wishlist on Moment Hub. Discover amazing gifts and make wishes come true!">
    <meta property="og:image" content="https://momentshub.org/assets/logo-single.png">
    <meta property="og:url" content="https://momentshub.org">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Moment Hub">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Wishlist - Moment Hub">
    <meta name="twitter:description" content="Check out this amazing wishlist on Moment Hub. Discover amazing gifts and make wishes come true!">
    <meta name="twitter:image" content="https://momentshub.org/assets/logo-single.png">
    
    <script>
        // This script will update meta tags based on URL parameters
        // This is a fallback for social media crawlers that don't execute JavaScript
        (function() {
            const urlParams = new URLSearchParams(window.location.search);
            const wishlistId = urlParams.get('id');
            const username = urlParams.get('username');
            
            if (wishlistId) {
                // Update meta tags with wishlist information
                const title = username ? `${username}'s Wishlist - Moment Hub` : 'Wishlist - Moment Hub';
                const description = username ? 
                    `Check out ${username}'s wishlist on Moment Hub. Discover amazing gifts and make their wishes come true!` :
                    'Check out this amazing wishlist on Moment Hub. Discover amazing gifts and make wishes come true!';
                
                // Update Open Graph tags
                document.querySelector('meta[property="og:title"]').setAttribute('content', title);
                document.querySelector('meta[property="og:description"]').setAttribute('content', description);
                document.querySelector('meta[property="og:url"]').setAttribute('content', window.location.href);
                
                // Update Twitter tags
                document.querySelector('meta[name="twitter:title"]').setAttribute('content', title);
                document.querySelector('meta[name="twitter:description"]').setAttribute('content', description);
                
                // Update page title
                document.title = title;
                
                // Try to fetch actual wishlist data for better meta tags
                fetch(`https://be.momentshub.org/api/wishlists/${wishlistId}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.success && data.data) {
                            const wishlist = data.data;
                            const wishlistName = wishlist.name || 'Wishlist';
                            const actualUsername = wishlist.user?.username || username || 'Someone';
                            const description = wishlist.description || 'Discover amazing gifts and make their wishes come true!';
                            
                            // Get wishlist image
                            let imageUrl = 'https://momentshub.org/assets/logo-single.png';
                            if (wishlist.photo) {
                                imageUrl = wishlist.photo;
                            } else if (wishlist.category?.slug) {
                                imageUrl = `https://momentshub.org/assets/${wishlist.category.slug}.svg`;
                            }
                            
                            // Update meta tags with actual data
                            const title = `${wishlistName} - ${actualUsername}'s Wishlist`;
                            const desc = `Check out ${actualUsername}'s wishlist on Moment Hub. ${description}`;
                            
                            document.querySelector('meta[property="og:title"]').setAttribute('content', title);
                            document.querySelector('meta[property="og:description"]').setAttribute('content', desc);
                            document.querySelector('meta[property="og:image"]').setAttribute('content', imageUrl);
                            document.querySelector('meta[name="twitter:title"]').setAttribute('content', title);
                            document.querySelector('meta[name="twitter:description"]').setAttribute('content', desc);
                            document.querySelector('meta[name="twitter:image"]').setAttribute('content', imageUrl);
                            document.title = title;
                        }
                    })
                    .catch(error => {
                        console.log('Could not fetch wishlist data, using fallback meta tags');
                    });
            }
        })();
    </script>
</head>
<body>
    <div id="app">
        <h1>Wishlist - Moment Hub</h1>
        <p>Redirecting to the wishlist...</p>
    </div>
    
    <script>
        // Redirect to the actual wishlist page
        const urlParams = new URLSearchParams(window.location.search);
        const wishlistId = urlParams.get('id');
        const username = urlParams.get('username');
        
        if (wishlistId) {
            const redirectUrl = username ? 
                `/wishlist/${wishlistId}/${username}` : 
                `/wishlist/${wishlistId}`;
            
            window.location.href = redirectUrl;
        } else {
            window.location.href = '/';
        }
    </script>
</body>
</html>
